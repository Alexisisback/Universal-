-- GUI de Ping
local Ping = Instance.new("ScreenGui")
local Pingtext = Instance.new("TextLabel")

Ping.Name = "Ping"
Ping.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
Ping.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
Ping.ResetOnSpawn = false

Pingtext.Name = "Pingtext"
Pingtext.Parent = Ping
Pingtext.BackgroundTransparency = 1

-- Variables para posiciones iniciales en PC
local initialPingPositionPC = UDim2.new(1, -230, 0, 0)
local initialFPSPositionPC = UDim2.new(1, -120, 0, 0)

-- Variables para posiciones iniciales en móviles
local initialPingPositionMobile = UDim2.new(1, -230, 1, -353)
local initialFPSPositionMobile = UDim2.new(1, -120, 1, -353)

-- Establecer posiciones iniciales según el entorno
local initialPingPosition = initialPingPositionPC
local initialFPSPosition = initialFPSPositionPC

Pingtext.Position = initialPingPosition
Pingtext.Size = UDim2.new(0, 100, 0, 25)
Pingtext.Font = Enum.Font.SourceSans
Pingtext.Text = "Ping: "
Pingtext.TextColor3 = Color3.fromRGB(255, 255, 255)
Pingtext.TextStrokeTransparency = 0.5
Pingtext.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
Pingtext.TextScaled = true
Pingtext.TextSize = 14.000
Pingtext.TextWrapped = true

-- Actualización del Ping
game:GetService("RunService").RenderStepped:Connect(function() 
    Pingtext.Text = "Ping: " .. game:GetService("Stats").Network.ServerStatsItem["Data Ping"]:GetValueString(math.round(2/game.Workspace:GetRealPhysicsFPS()))
end)

-- Actualización de FPS
local lastTime = tick()
local frameCount = 0

local TextLabel = Instance.new("TextLabel") 
TextLabel.Name = "FPSLabel"
TextLabel.Parent = Ping
TextLabel.BackgroundTransparency = 1

TextLabel.Position = initialFPSPosition
TextLabel.Size = UDim2.new(0, 45, 0, 25)
TextLabel.Font = Enum.Font.SourceSans
TextLabel.Text = "FPS: "
TextLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
TextLabel.TextStrokeTransparency = 0.5
TextLabel.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
TextLabel.TextScaled = true
TextLabel.TextSize = 14.000
TextLabel.TextWrapped = true

-- Función para formatear el FPS y cambiar el color si está por debajo de 25
local function FormatFPS(fps)
    local formattedFPS = string.format("FPS: %d", math.floor(fps + 0.5))

    -- Cambiar el color del texto si los FPS están por debajo de 25
    if fps < 30 then
        TextLabel.TextColor3 = Color3.new(1, 0, 0) -- Rojo
    else
        TextLabel.TextColor3 = Color3.new(1, 1, 1) -- Blanco
    end

    return formattedFPS
end

-- Actualización de FPS
game:GetService("RunService").RenderStepped:Connect(function()
    local currentTime = tick()
    frameCount = frameCount + 1
    
    if currentTime - lastTime >= 1 then
        local fps = frameCount / (currentTime - lastTime)
        TextLabel.Text = FormatFPS(fps)
        frameCount = 0
        lastTime = currentTime
    end
end)

-- Función para actualizar las posiciones según el entorno
local function updatePositions(isMobile)
    if isMobile then
        initialPingPosition = UDim2.new(1, -230, 1, -353)
        initialFPSPosition = UDim2.new(1, -120, 1, -353)
    else
        initialPingPosition = UDim2.new(1, -230, 0, 0)
        initialFPSPosition = UDim2.new(1, -120, 0, 0)
    end
end

-- Detectar cambios en la interfaz de usuario (PC a móvil y viceversa)
game:GetService("UserInputService").UserInterfaceChanged:Connect(function()
    local isMobile = game:GetService("UserInputService").TouchEnabled
    updatePositions(isMobile)
    Pingtext.Position = initialPingPosition
    TextLabel.Position = initialFPSPosition
end)
